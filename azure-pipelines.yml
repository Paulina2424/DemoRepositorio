
variables:
  imageName: 'pipelines-javascript-docker'
stages:
  - stage: Build
    jobs:
      - job: BuildMS
        pool:
          vmImage: 'ubuntu-latest'
        steps:
          - script: chmod 777 gradlew
            name: permisos
          - script: ./gradlew build
            name: build
  - stage:
    jobs:
      - job: Docker
        pool:
          vmImage: 'ubuntu-latest'
        steps:
          - task: Docker@2
            displayName: Build
            inputs:
              command: build
              containerRegistry: dockerRegistryServiceConnection1
              repository: contosoRepository
              tags: latest
              arguments: --label buildtype=nightly

          - task: Docker@2
            displayName: Push
            inputs:
              command: push
              containerRegistry: dockerRegistryServiceConnection1
              repository: contosoRepository
              tags: latest
